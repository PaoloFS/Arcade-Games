<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Arcade Zone - Multiplayer Games</title>
	<style>
	@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Orbitron:wght@400;700;900&display=swap');

	* {
		box-sizing: border-box;
		margin: 0;
		padding: 0;
	}

	:root {
		--neon-cyan: #00fff9;
		--neon-pink: #ff006e;
		--neon-yellow: #ffbe0b;
		--neon-purple: #8338ec;
		--dark-bg: #0a0e27;
		--darker-bg: #050812;
		--card-bg: rgba(15, 23, 42, 0.9);
		
		/* Spacing escalado */
		--spacing-xs: clamp(0.25rem, 1vw, 0.5rem);
		--spacing-sm: clamp(0.5rem, 2vw, 1rem);
		--spacing-md: clamp(1rem, 3vw, 1.5rem);
		--spacing-lg: clamp(1.5rem, 4vw, 2rem);
		--spacing-xl: clamp(2rem, 5vw, 3rem);
		
		/* Font sizes fluidos */
		--fs-xs: clamp(0.7rem, 2vw, 0.8rem);
		--fs-sm: clamp(0.8rem, 2.5vw, 0.9rem);
		--fs-base: clamp(0.9rem, 3vw, 1.1rem);
		--fs-md: clamp(1rem, 3.5vw, 1.3rem);
		--fs-lg: clamp(1.3rem, 4vw, 1.5rem);
		--fs-xl: clamp(1.5rem, 5vw, 2rem);
		--fs-2xl: clamp(2rem, 6vw, 3rem);
		--fs-3xl: clamp(2.5rem, 7vw, 4rem);
	}

	body {
		min-height: 100vh;
		background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0a0e27 100%);
		font-family: 'Orbitron', sans-serif;
		color: #fff;
		overflow-x: hidden;
		position: relative;
	}

	/* Animated Background */
	.animated-bg {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 0;
		overflow: hidden;
		pointer-events: none;
	}

	.grid-lines {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-image: 
			linear-gradient(rgba(0, 255, 249, 0.08) 1px, transparent 1px),
			linear-gradient(90deg, rgba(0, 255, 249, 0.08) 1px, transparent 1px);
		background-size: clamp(30px, 5vw, 50px) clamp(30px, 5vw, 50px);
		animation: gridMove 20s linear infinite;
		opacity: 0.6;
	}

	@keyframes gridMove {
		0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
		100% { transform: perspective(500px) rotateX(60deg) translateY(50px); }
	}

	.stars {
		position: absolute;
		width: 100%;
		height: 100%;
	}

	.star {
		position: absolute;
		width: 2px;
		height: 2px;
		background: white;
		border-radius: 50%;
		animation: twinkle 3s infinite;
	}

	@keyframes twinkle {
		0%, 100% { opacity: 0.2; }
		50% { opacity: 0.8; }
	}

	.container {
		position: relative;
		z-index: 1;
		max-width: min(1400px, 95vw);
		margin: 0 auto;
		padding: var(--spacing-lg);
	}

	/* Header */
	.header {
		text-align: center;
		margin-bottom: var(--spacing-xl);
		position: relative;
	}

	.header h1 {
		font-family: 'Press Start 2P', cursive;
		font-size: var(--fs-2xl);
		background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink), var(--neon-yellow));
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
		line-height: 1.4;
		margin-bottom: var(--spacing-sm);
		filter: drop-shadow(0 0 20px rgba(0, 255, 249, 0.4));
	}

	.header p {
		font-size: var(--fs-base);
		color: var(--neon-cyan);
		letter-spacing: 0.1em;
	}

	/* User Panel */
	.user-panel {
		background: var(--card-bg);
		border: 2px solid var(--neon-cyan);
		border-radius: clamp(10px, 2vw, 15px);
		padding: var(--spacing-md);
		margin-bottom: var(--spacing-xl);
		backdrop-filter: blur(10px);
		box-shadow: 0 0 25px rgba(0, 255, 249, 0.25);
		display: flex;
		justify-content: center;
		align-items: center;
		flex-wrap: wrap;
		gap: var(--spacing-md);
	}

	.user-info {
		display: flex;
		align-items: center;
		gap: var(--spacing-sm);
	}

	.user-avatar {
		width: clamp(40px, 8vw, 50px);
		height: clamp(40px, 8vw, 50px);
		background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: var(--fs-lg);
		border: 3px solid var(--neon-cyan);
		flex-shrink: 0;
	}

	.user-name {
		font-size: var(--fs-md);
		font-weight: 700;
		color: var(--neon-yellow);
	}

	.input-group {
		display: flex;
		gap: var(--spacing-sm);
		align-items: center;
		flex-wrap: wrap;
		justify-content: center;
	}

	.arcade-input {
		padding: clamp(0.6rem, 2vw, 0.8rem) clamp(0.8rem, 3vw, 1.2rem);
		background: rgba(0, 0, 0, 0.5);
		border: 2px solid var(--neon-cyan);
		border-radius: 8px;
		color: white;
		font-family: 'Orbitron', sans-serif;
		font-size: var(--fs-sm);
		min-width: min(200px, 100%);
		transition: all 0.3s ease;
	}

	.arcade-input:focus {
		outline: none;
		border-color: var(--neon-pink);
		box-shadow: 0 0 15px rgba(255, 0, 110, 0.4);
	}

	.arcade-btn {
		padding: clamp(0.6rem, 2vw, 0.8rem) clamp(1rem, 3vw, 1.8rem);
		background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
		border: 2px solid var(--neon-cyan);
		color: white;
		font-family: 'Orbitron', sans-serif;
		font-weight: 700;
		font-size: var(--fs-sm);
		border-radius: 8px;
		cursor: pointer;
		transition: all 0.3s ease;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		position: relative;
		overflow: hidden;
		white-space: nowrap;
	}

	.arcade-btn:hover {
		transform: translateY(-2px);
		box-shadow: 0 5px 20px rgba(255, 0, 110, 0.6);
	}

	.arcade-btn:active {
		transform: translateY(0);
	}

	.arcade-btn:disabled {
		opacity: 0.5;
		cursor: not-allowed;
	}

	/* Game Cards */
	.games-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
		gap: var(--spacing-lg);
		margin-bottom: var(--spacing-xl);
	}

	.game-card {
		background: var(--card-bg);
		border: 2px solid transparent;
		border-radius: clamp(15px, 3vw, 20px);
		padding: var(--spacing-lg);
		cursor: pointer;
		transition: all 0.4s ease;
		position: relative;
		overflow: hidden;
		backdrop-filter: blur(10px);
	}

	.game-card::before {
		content: '';
		position: absolute;
		top: -50%;
		left: -50%;
		width: 200%;
		height: 200%;
		background: linear-gradient(45deg, transparent, rgba(0, 255, 249, 0.08), transparent);
		transform: rotate(45deg);
		transition: all 0.5s ease;
	}

	.game-card:hover::before {
		animation: shimmer 1.5s infinite;
	}

	@keyframes shimmer {
		0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
		100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
	}

	.game-card:hover {
		border-color: var(--neon-cyan);
		transform: translateY(-8px);
		box-shadow: 0 15px 40px rgba(0, 255, 249, 0.3);
	}

	.game-icon {
		font-size: clamp(3rem, 8vw, 4rem);
		text-align: center;
		margin-bottom: var(--spacing-sm);
		filter: drop-shadow(0 0 8px currentColor);
	}

	.game-card:nth-child(1) .game-icon { color: var(--neon-yellow); }
	.game-card:nth-child(2) .game-icon { color: var(--neon-pink); }

	.game-title {
		font-family: 'Press Start 2P', cursive;
		font-size: var(--fs-md);
		text-align: center;
		margin-bottom: var(--spacing-xs);
		color: var(--neon-cyan);
		line-height: 1.5;
	}

	.game-description {
		text-align: center;
		opacity: 0.8;
		margin-bottom: var(--spacing-md);
		font-size: var(--fs-sm);
		line-height: 1.5;
	}

	.game-stats-preview {
		display: flex;
		justify-content: space-around;
		padding: var(--spacing-sm);
		background: rgba(0, 0, 0, 0.3);
		border-radius: 10px;
		margin-bottom: var(--spacing-sm);
		gap: var(--spacing-sm);
	}

	.stat-preview {
		text-align: center;
		flex: 1;
	}

	.stat-preview-value {
		font-size: var(--fs-lg);
		font-weight: 700;
		color: var(--neon-yellow);
	}

	.stat-preview-label {
		font-size: var(--fs-xs);
		opacity: 0.7;
		text-transform: uppercase;
	}

	/* Modal */
	.modal {
		display: none;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background: rgba(0, 0, 0, 0.9);
		z-index: 1000;
		backdrop-filter: blur(5px);
	}

	.modal.active {
		display: flex;
		align-items: center;
		justify-content: center;
		animation: fadeIn 0.3s ease;
		padding: var(--spacing-md);
	}

	@keyframes fadeIn {
		from { opacity: 0; }
		to { opacity: 1; }
	}

	.modal-content {
		background: var(--dark-bg);
		border: 3px solid var(--neon-cyan);
		border-radius: clamp(15px, 3vw, 20px);
		padding: var(--spacing-lg);
		max-width: min(900px, 95vw);
		width: 100%;
		max-height: 90vh;
		overflow-y: auto;
		position: relative;
		box-shadow: 0 0 40px rgba(0, 255, 249, 0.4);
		animation: slideUp 0.4s ease;
		display: flex;
		flex-direction: column;
	}

	@keyframes slideUp {
		from { transform: translateY(30px); opacity: 0; }
		to { transform: translateY(0); opacity: 1; }
	}

	.modal-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: var(--spacing-lg);
		padding-bottom: var(--spacing-sm);
		border-bottom: 2px solid var(--neon-cyan);
		gap: var(--spacing-sm);
	}

	.modal-title {
		font-family: 'Press Start 2P', cursive;
		font-size: var(--fs-lg);
		color: var(--neon-yellow);
		line-height: 1.4;
	}

	.close-btn {
		background: transparent;
		border: 2px solid var(--neon-pink);
		color: var(--neon-pink);
		width: clamp(35px, 8vw, 40px);
		height: clamp(35px, 8vw, 40px);
		border-radius: 50%;
		cursor: pointer;
		font-size: var(--fs-lg);
		transition: all 0.3s ease;
		flex-shrink: 0;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.close-btn:hover {
		background: var(--neon-pink);
		color: white;
		transform: rotate(90deg);
	}

	/* Game Stats */
	.game-stats {
		display: flex;
		justify-content: space-around;
		flex-wrap: wrap;
		margin-bottom: var(--spacing-lg);
		padding: var(--spacing-md);
		background: rgba(0, 0, 0, 0.3);
		border-radius: 10px;
		gap: var(--spacing-md);
	}

	.stat {
		text-align: center;
		flex: 1;
		min-width: min(100px, 30%);
	}

	.stat-value {
		font-size: var(--fs-xl);
		font-weight: 700;
		color: var(--neon-yellow);
		font-family: 'Press Start 2P', cursive;
	}

	.stat-label {
		font-size: var(--fs-xs);
		opacity: 0.7;
		text-transform: uppercase;
		margin-top: 0.3rem;
	}

	/* Catch Game Area */
	.catch-game-area {
		position: relative;
		width: 100%;
		max-width: min(700px, 100%);
		margin: 0 auto var(--spacing-md);
		height: clamp(300px, 50vh, 450px);
		background: linear-gradient(180deg, #0a0e27 0%, #1a1035 100%);
		border: 3px solid var(--neon-cyan);
		border-radius: 15px;
		overflow: hidden;
		box-shadow: inset 0 0 40px rgba(0, 255, 249, 0.2);
		flex-shrink: 0;
	}

	.catcher {
		position: absolute;
		bottom: 20px;
		width: clamp(60px, 12vw, 80px);
		height: clamp(60px, 12vw, 80px);
		font-size: clamp(2.5rem, 6vw, 3rem);
		transition: left 0.05s linear;
		cursor: move;
		filter: drop-shadow(0 0 8px rgba(255, 190, 11, 0.8));
		z-index: 10;
		user-select: none;
	}

	.falling-item {
		position: absolute;
		font-size: clamp(2rem, 5vw, 2.5rem);
		pointer-events: none;
		filter: drop-shadow(0 0 8px currentColor);
		user-select: none;
	}

	.powerup {
		animation: pulse 0.5s ease-in-out infinite;
	}

	@keyframes pulse {
		0%, 100% { transform: scale(1); }
		50% { transform: scale(1.15); }
	}

	/* Memory Game */
	.memory-grid {
		display: grid;
		grid-template-columns: repeat(4, 1fr);
		gap: clamp(0.5rem, 2vw, 0.8rem);
		margin-bottom: var(--spacing-md);
		max-width: min(500px, 100%);
		margin-left: auto;
		margin-right: auto;
		flex-shrink: 0;
	}

	.memory-card {
		aspect-ratio: 1;
		background: linear-gradient(135deg, rgba(0, 255, 249, 0.1), rgba(131, 56, 236, 0.1));
		border: 3px solid var(--neon-cyan);
		border-radius: clamp(10px, 2vw, 15px);
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: clamp(2rem, 6vw, 3rem);
		transition: all 0.4s ease;
		position: relative;
		transform-style: preserve-3d;
		min-height: 0;
		user-select: none;
	}

	.memory-card:hover:not(.flipped):not(.matched) {
		transform: scale(1.05);
		border-color: var(--neon-pink);
		box-shadow: 0 0 25px rgba(255, 0, 110, 0.4);
	}

	.memory-card.flipped {
		background: linear-gradient(135deg, rgba(255, 0, 110, 0.3), rgba(131, 56, 236, 0.3));
		border-color: var(--neon-pink);
		transform: rotateY(180deg) scale(1);
	}

	.memory-card.matched {
		background: linear-gradient(135deg, rgba(0, 255, 249, 0.3), rgba(255, 190, 11, 0.3));
		border-color: var(--neon-yellow);
		cursor: default;
		animation: matchPulse 0.5s ease;
		transform: scale(1);
	}

	@keyframes matchPulse {
		0%, 100% { transform: scale(1); }
		50% { transform: scale(1.1); }
	}

	/* Leaderboard */
	.leaderboard-section {
		background: var(--card-bg);
		border: 2px solid var(--neon-purple);
		border-radius: clamp(15px, 3vw, 20px);
		padding: var(--spacing-lg);
		backdrop-filter: blur(10px);
	}

	.leaderboard-title {
		font-family: 'Press Start 2P', cursive;
		font-size: var(--fs-lg);
		text-align: center;
		margin-bottom: var(--spacing-lg);
		color: var(--neon-yellow);
		line-height: 1.4;
	}

	.leaderboard-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
		gap: var(--spacing-lg);
	}

	.leaderboard-box {
		background: rgba(0, 0, 0, 0.3);
		border: 2px solid var(--neon-cyan);
		border-radius: 15px;
		padding: var(--spacing-md);
	}

	.leaderboard-box h3 {
		text-align: center;
		color: var(--neon-pink);
		margin-bottom: var(--spacing-md);
		font-size: var(--fs-md);
	}

	.leaderboard-list {
		list-style: none;
	}

	.leaderboard-item {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: var(--spacing-sm);
		margin-bottom: var(--spacing-xs);
		background: rgba(0, 255, 249, 0.05);
		border: 1px solid rgba(0, 255, 249, 0.2);
		border-radius: 10px;
		transition: all 0.3s ease;
		gap: var(--spacing-sm);
	}

	.leaderboard-item:hover {
		background: rgba(0, 255, 249, 0.1);
		transform: translateX(5px);
		border-color: var(--neon-cyan);
	}

	.leaderboard-item.top-1 {
		background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 190, 11, 0.1));
		border: 2px solid gold;
	}

	.leaderboard-item.top-2 {
		background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(169, 169, 169, 0.1));
		border: 2px solid silver;
	}

	.leaderboard-item.top-3 {
		background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(184, 115, 51, 0.1));
		border: 2px solid #cd7f32;
	}

	.leaderboard-rank {
		font-size: var(--fs-md);
		font-weight: 700;
		min-width: clamp(40px, 8vw, 50px);
		text-align: center;
	}

	.leaderboard-name {
		flex: 1;
		margin: 0 var(--spacing-sm);
		font-weight: 600;
		font-size: var(--fs-sm);
		word-break: break-word;
	}

	.leaderboard-score {
		font-size: var(--fs-md);
		font-weight: 700;
		color: var(--neon-yellow);
	}

	.no-scores {
		text-align: center;
		opacity: 0.5;
		padding: var(--spacing-lg);
		font-style: italic;
		font-size: var(--fs-sm);
	}

	/* Game Over Alert */
	.game-over-alert {
		position: fixed;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%) scale(0);
		background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink));
		padding: var(--spacing-xl);
		border-radius: clamp(15px, 3vw, 20px);
		border: 3px solid var(--neon-cyan);
		box-shadow: 0 0 80px rgba(0, 255, 249, 0.6);
		text-align: center;
		z-index: 2000;
		transition: transform 0.3s ease;
		max-width: min(500px, 90vw);
	}

	.game-over-alert.active {
		transform: translate(-50%, -50%) scale(1);
	}

	.game-over-alert h2 {
		font-family: 'Press Start 2P', cursive;
		font-size: var(--fs-xl);
		margin-bottom: var(--spacing-sm);
		color: var(--neon-yellow);
		line-height: 1.4;
	}

	.final-score-display {
		font-size: var(--fs-3xl);
		font-weight: 900;
		color: white;
		margin: var(--spacing-sm) 0;
		text-shadow: 0 0 25px rgba(255, 255, 255, 0.8);
	}

	/* Ajuste para pantallas peque√±as */
	@media (max-width: 480px) {
		.memory-grid {
			gap: clamp(0.3rem, 1.5vw, 0.5rem);
		}
		
		.game-stats {
			flex-direction: column;
		}
		
		.stat {
			min-width: 100%;
		}
	}

	/* Touch device optimizations */
	@media (hover: none) and (pointer: coarse) {
		.game-card:hover {
			transform: none;
		}
		
		.game-card:active {
			transform: scale(0.98);
		}
		
		.arcade-btn:hover {
			transform: none;
		}
		
		.arcade-btn:active {
			transform: scale(0.95);
		}
	}
	</style>
	<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
</head>
<body>
	<div class="animated-bg">
		<div class="grid-lines"></div>
		<div class="stars" id="starsContainer"></div>
	</div>

	<div class="container">
		<div class="header">
			<h1>ARCADE ZONE</h1>
			<p>‚óÜ MULTIPLAYER GAMES ‚óÜ</p>
		</div>

		<!-- User Panel -->
		<div class="user-panel">
		¬† ¬†¬†
		¬† ¬† <div id="loginView">
		¬† ¬† ¬† ¬† <button class="arcade-btn" onclick="loginWithGoogle()">
		¬† ¬† ¬† ¬† ¬† ¬† ‚≠ê SIGN IN WITH GOOGLE TO PLAY ‚≠ê
		¬† ¬† ¬† ¬† </button>
		¬† ¬† </div>
		
		    ¬† ¬† <div id="userView" style="display: none;">
		¬† ¬† ¬† ¬† <div class="user-info">
		¬† ¬† ¬† ¬† ¬† ¬† <div class="user-avatar">üéÆ</div>
		¬† ¬† ¬† ¬† ¬† ¬† <div>
		                ¬† ¬† ¬† ¬† ¬†<div class="user-name" id="displayUsername"></div> 
		¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†¬†
		¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <div style="font-size: 0.8rem; opacity: 0.7;">PLAYER</div>
		¬† ¬† ¬† ¬† ¬† ¬† </div>
		¬† ¬† ¬† ¬† </div>
		¬† ¬† ¬† ¬† <button class="arcade-btn" onclick="logout()">LOGOUT</button>
		¬† ¬† </div>
		
		</div>

		<!-- Games Grid -->
		<div class="games-grid">
			<!-- Star Catcher Card -->
			<div class="game-card" onclick="openGame('catch')">
				<div class="game-icon">‚≠ê</div>
				<h3 class="game-title">STAR CATCHER</h3>
				<p class="game-description">Catch stars and power-ups while avoiding bombs!</p>
				<div class="game-stats-preview">
					<div class="stat-preview">
						<div class="stat-preview-value" id="catchBestPreview">-</div>
						<div class="stat-preview-label">Your Best</div>
					</div>
					<div class="stat-preview">
						<div class="stat-preview-value" id="catchWorldPreview">-</div>
						<div class="stat-preview-label">World Record</div>
					</div>
				</div>
				<div style="text-align: center; margin-top: 1rem;">
					<button class="arcade-btn" onclick="event.stopPropagation(); openGame('catch')">PLAY NOW</button>
				</div>
			</div>

			<!-- Memory Game Card -->
			<div class="game-card" onclick="openGame('memory')">
				<div class="game-icon">üß†</div>
				<h3 class="game-title">MEMORY MASTER</h3>
				<p class="game-description">Match all pairs in the fewest moves!</p>
				<div class="game-stats-preview">
					<div class="stat-preview">
						<div class="stat-preview-value" id="memoryBestPreview">-</div>
						<div class="stat-preview-label">Your Best</div>
					</div>
					<div class="stat-preview">
						<div class="stat-preview-value" id="memoryWorldPreview">-</div>
						<div class="stat-preview-label">World Record</div>
					</div>
				</div>
				<div style="text-align: center; margin-top: 1rem;">
					<button class="arcade-btn" onclick="event.stopPropagation(); openGame('memory')">PLAY NOW</button>
				</div>
			</div>
		</div>

		<!-- Leaderboard Section -->
		<div class="leaderboard-section">
			<h2 class="leaderboard-title">‚óÜ GLOBAL LEADERBOARD ‚óÜ</h2>
			<div class="leaderboard-grid">
				<div class="leaderboard-box">
					<h3>‚≠ê STAR CATCHER</h3>
					<ul class="leaderboard-list" id="catchLeaderboard">
						<li class="no-scores">Loading...</li>
					</ul>
				</div>
				<div class="leaderboard-box">
					<h3>üß† MEMORY MASTER</h3>
					<ul class="leaderboard-list" id="memoryLeaderboard">
						<li class="no-scores">Loading...</li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<!-- Catch Game Modal -->
	<div class="modal" id="catchModal">
		<div class="modal-content">
			<div class="modal-header">
				<h2 class="modal-title">‚≠ê STAR CATCHER</h2>
				<button class="close-btn" onclick="closeGame('catch')">√ó</button>
			</div>

			<div class="game-stats">
				<div class="stat">
					<div class="stat-value" id="catchScore">0</div>
					<div class="stat-label">Score</div>
				</div>
				<div class="stat">
					<div class="stat-value" id="catchTime">30</div>
					<div class="stat-label">Time</div>
				</div>
				<div class="stat">
					<div class="stat-value" id="catchMultiplier">x1</div>
					<div class="stat-label">Multiplier</div>
				</div>
			</div>

			<div class="catch-game-area" id="catchGameArea">
				<div class="catcher" id="catcher">üéØ</div>
			</div>

			<div style="text-align: center;">
				<button class="arcade-btn" onclick="startCatchGame()" id="catchStartBtn">START GAME</button>
			</div>

			<div style="margin-top: 2rem; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 10px; font-size: 0.9rem;">
				<strong>POWER-UPS:</strong><br>
				‚ö° Speed Boost | üåü Double Points | ‚è∞ Time Extension | üõ°Ô∏è Shield
			</div>
		</div>
	</div>

	<!-- Memory Game Modal -->
	<div class="modal" id="memoryModal">
		<div class="modal-content">
			<div class="modal-header">
				<h2 class="modal-title">üß† MEMORY MASTER</h2>
				<button class="close-btn" onclick="closeGame('memory')">√ó</button>
			</div>

			<div class="game-stats">
				<div class="stat">
					<div class="stat-value" id="memoryMoves">0</div>
					<div class="stat-label">Moves</div>
				</div>
				<div class="stat">
					<div class="stat-value" id="memoryPairs">0/8</div>
					<div class="stat-label">Pairs</div>
				</div>
			</div>

			<div class="memory-grid" id="memoryGrid"></div>

			<div style="text-align: center;">
				<button class="arcade-btn" onclick="initMemoryGame()">NEW GAME</button>
			</div>
		</div>
	</div>

	<!-- Game Over Alert -->
	<div class="game-over-alert" id="gameOverAlert">
		<div style="font-size: 4rem;">üèÜ</div>
		<h2>GAME OVER!</h2>
		<p style="opacity: 0.8; margin-bottom: 0.5rem;">FINAL SCORE</p>
		<div class="final-score-display" id="finalScore">0</div>
		<button class="arcade-btn" onclick="closeGameOverAlert()" style="margin-top: 1rem;">CONTINUE</button>
	</div>

	<!-- Memory Victory Alert -->
	<div class="game-over-alert" id="memoryVictoryAlert">
		<div style="font-size: 4rem;">üéâ</div>
		<h2>PERFECT!</h2>
		<p style="opacity: 0.8; margin-bottom: 0.5rem;">COMPLETED IN</p>
		<div class="final-score-display" id="finalMoves">0</div>
		<p style="font-size: 1.2rem; margin-top: 0.5rem;">MOVES</p>
		<button class="arcade-btn" onclick="closeMemoryVictory()" style="margin-top: 1rem;">PLAY AGAIN</button>
	</div>

	<!-- Login Required Alert -->
	<div class="game-over-alert" id="loginAlert">
		<div style="font-size: 4rem;">üîí</div>
		<h2 style="font-size: 1.5rem;">LOGIN REQUIRED</h2>
		<p style="opacity: 0.8; margin: 1.5rem 0; font-size: 1rem;">Sign in with Google to save your scores and compete on the leaderboard!</p>
		<button class="arcade-btn" onclick="closeLoginAlert(); loginWithGoogle();" style="margin-top: 1rem;">
			‚≠ê SIGN IN NOW ‚≠ê
		</button>
		<button class="arcade-btn" onclick="closeLoginAlert()" style="margin-top: 0.5rem; background: rgba(255,255,255,0.1);">
			CANCEL
		</button>
	</div>

	<script>
		// Initialize stars
		const starsContainer = document.getElementById('starsContainer');
		for (let i = 0; i < 100; i++) {
			const star = document.createElement('div');
			star.className = 'star';
			star.style.left = Math.random() * 100 + '%';
			star.style.top = Math.random() * 100 + '%';
			star.style.animationDelay = Math.random() * 3 + 's';
			starsContainer.appendChild(star);
		}

		// ===== A√ëADE ESTO: INICIALIZACI√ìN DE FIREBASE =====
    
	    // Pega aqu√≠ tu objeto de configuraci√≥n que copiaste
	    const firebaseConfig = {
	      apiKey: "AIzaSyDipUw7d4av0JwfudVDdECNjZXdjy3OGyw",
	      authDomain: "juego-arcade-scores.firebaseapp.com",
	      projectId: "juego-arcade-scores",
	      storageBucket: "juego-arcade-scores.firebasestorage.app",
	      messagingSenderId: "33838418828",
	      appId: "1:33838418828:web:5aa1579a7f645992c2a4a9",
	      measurementId: "G-47JPGCPBM0"
	    };

	    // Inicializa Firebase y Firestore
	    firebase.initializeApp(firebaseConfig);
	    const db = firebase.firestore();
	    
	    // ===== FIN DE LA INICIALIZACI√ìN DE FIREBASE =====

// ===== USER MANAGEMENT & FIRESTORE LOGIC =====
// 1. Define la variable 'auth'
        const auth = firebase.auth();
		let currentUser = null; // Esto ahora ser√° un objeto de Firebase, no un string

		// 2. Nueva funci√≥n: Iniciar sesi√≥n con Google
		async function loginWithGoogle() {
			try {
                // Crea un "proveedor" de Google
				const provider = new firebase.auth.GoogleAuthProvider();
                // Abre una ventana emergente para iniciar sesi√≥n
				await auth.signInWithPopup(provider);
                // El 'observer' (initAuth) se encargar√° del resto
                
			} catch (error) {
				console.error("Error al iniciar sesi√≥n con Google:", error);
                alert("Hubo un error al iniciar sesi√≥n.");
			}
		}

		// 3. Nueva funci√≥n: Salir
		async function logout() {
			try {
                // Le dice a Firebase que cierre la sesi√≥n
				await auth.signOut();
                // El 'observer' (initAuth) se encargar√° del resto
			} catch (error) {
				console.error("Error al cerrar sesi√≥n:", error);
			}
		}

        // 4. Nueva funci√≥n: El "Observador"
        // Esta funci√≥n se ejecuta CADA VEZ que el estado de login cambia
        function initAuth() {
            auth.onAuthStateChanged(user => {
                if (user) {
                    // *** EL USUARIO EST√Å CONECTADO ***
                    console.log("Usuario conectado:", user.displayName, user.uid);
                    currentUser = user; // Guardamos el objeto de usuario COMPLETO
                    
                    document.getElementById('loginView').style.display = 'none';
                    document.getElementById('userView').style.display = 'flex';
                    // Mostramos su nombre real de Google
                    document.getElementById('displayUsername').textContent = user.displayName;
                    
                    loadUserStats();
                    loadLeaderboards();
                
					} else {
                    // *** EL USUARIO EST√Å DESCONECTADO ***
                    console.log("User logged out.");
                    currentUser = null;
                    
                    document.getElementById('loginView').style.display = 'block';
                    document.getElementById('userView').style.display = 'none';
                    
                    closeGame('catch');
                    closeGame('memory');
                    
                    // Limpiar S√ìLO las vistas previas PERSONALES
                    document.getElementById('catchBestPreview').textContent = '-';
                    document.getElementById('memoryBestPreview').textContent = '-';
                    
                    // CARGAR los leaderboards globales
                    loadLeaderboards();
                }
            });
        }

        // 5. Llama al observador cuando la p√°gina cargue
        document.addEventListener('DOMContentLoaded', initAuth);

		function isStorageAvailable() {
			// Esta funci√≥n ahora comprueba si 'db' (nuestra base de datos) existe.
			return typeof db !== 'undefined' && db !== null;
		}

		async function loadUserStats() {
            // Ahora currentUser es un objeto, por eso chequeamos 'currentUser.uid'
			if (!currentUser || !currentUser.uid || !isStorageAvailable()) return;
			
			try {
                // Usamos el UID, no el nombre
				const docId = currentUser.uid; 
				
				// Cargar mejor puntaje de Catch
				const catchDoc = await db.collection('user_best_catch').doc(docId).get();
				if (catchDoc.exists) {
					document.getElementById('catchBestPreview').textContent = catchDoc.data().score;
				}

				// Cargar mejor puntaje de Memory
				const memoryDoc = await db.collection('user_best_memory').doc(docId).get();
				if (memoryDoc.exists) {
					document.getElementById('memoryBestPreview').textContent = memoryDoc.data().score;
				}
			} catch (error) {
				console.error('Error loading user stats:', error);
			}
		}

		async function saveScore(game, score) {
			if (!currentUser || !currentUser.uid || !isStorageAvailable()) {
                console.log('User not logged in or DB not available. Score not saved.');
                return;
            }
			
            const isCatchGame = game === 'catch';
            const collectionName = isCatchGame ? 'user_best_catch' : 'user_best_memory';
            
            // ‚¨áÔ∏è ESTE ES EL CAMBIO M√ÅS IMPORTANTE ‚¨áÔ∏è
            // El ID del documento ahora es el UID del usuario
            const docId = currentUser.uid;
            const docRef = db.collection(collectionName).doc(docId);
            // ‚¨ÜÔ∏è FIN DEL CAMBIO IMPORTANTE ‚¨ÜÔ∏è

			try {
                const doc = await docRef.get();
                let shouldSave = false;

                if (!doc.exists) {
                    shouldSave = true;
                } else {
                    const existingScore = doc.data().score;
                    if (isCatchGame) {
                        if (score > existingScore) shouldSave = true;
                    } else {
                        if (score < existingScore) shouldSave = true;
                    }
                }

                if (shouldSave) {
                    console.log(`Saving new best score for ${game}: ${score}`);
                    await docRef.set({
                        // Tambi√©n guardamos el nombre (displayName) para mostrarlo en el leaderboard
                        username: currentUser.displayName, 
                        score: score,
                        timestamp: new Date()
                    });
                    
                    await loadUserStats();
                    await loadLeaderboards();
                } else {
                    console.log(`Score ${score} is not better than existing. Not saving.`);
                }
			} catch (error) {
				console.error('Error saving score:', error);
			}
		}

		async function loadLeaderboards() {
			if (!isStorageAvailable()) {
				document.getElementById('catchLeaderboard').innerHTML = '<li class="no-scores">Database not available</li>';
				document.getElementById('memoryLeaderboard').innerHTML = '<li class="no-scores">Database not available</li>';
				return;
			}
			await loadCatchLeaderboard();
			await loadMemoryLeaderboard();
		}

		async function loadCatchLeaderboard() {
			if (!isStorageAvailable()) return;
			
            const leaderboardEl = document.getElementById('catchLeaderboard');
            leaderboardEl.innerHTML = '<li class="no-scores">Loading...</li>';
            
			try {
                // Pedir a Firestore los 10 mejores, ordenados por 'score' descendente
                const snapshot = await db.collection('user_best_catch')
                                         .orderBy('score', 'desc')
                                         .limit(10)
                                         .get();

				if (snapshot.empty) {
					leaderboardEl.innerHTML = '<li class="no-scores">No scores yet. Be the first!</li>';
					document.getElementById('catchWorldPreview').textContent = '-';
					return;
				}

                const sortedScores = snapshot.docs.map(doc => doc.data());

                // Actualizar el "World Record"
				document.getElementById('catchWorldPreview').textContent = sortedScores[0].score;

				leaderboardEl.innerHTML = sortedScores.map((score, index) => {
					const rankClass = index === 0 ? 'top-1' : index === 1 ? 'top-2' : index === 2 ? 'top-3' : '';
					const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
					return `
						<li class="leaderboard-item ${rankClass}">
							<span class="leaderboard-rank">${medal}</span>
							<span class="leaderboard-name">${score.username}</span>
							<span class="leaderboard-score">${score.score}</span>
						</li>
					`;
				}).join('');
			} catch (error) {
				console.error('Error loading catch leaderboard:', error);
                leaderboardEl.innerHTML = '<li class="no-scores">Error loading scores</li>';
			}
		}

		async function loadMemoryLeaderboard() {
            if (!isStorageAvailable()) return;
            
            const leaderboardEl = document.getElementById('memoryLeaderboard');
            leaderboardEl.innerHTML = '<li class="no-scores">Loading...</li>';
            
			try {
                // Pedir a Firestore los 10 mejores, ordenados por 'score' ascendente (menos movimientos es mejor)
                const snapshot = await db.collection('user_best_memory')
                                         .orderBy('score', 'asc')
                                         .limit(10)
                                         .get();
                
				if (snapshot.empty) {
					leaderboardEl.innerHTML = '<li class="no-scores">No scores yet. Be the first!</li>';
					document.getElementById('memoryWorldPreview').textContent = '-';
					return;
				}

                const sortedScores = snapshot.docs.map(doc => doc.data());

                // Actualizar el "World Record"
				document.getElementById('memoryWorldPreview').textContent = sortedScores[0].score;

				leaderboardEl.innerHTML = sortedScores.map((score, index) => {
					const rankClass = index === 0 ? 'top-1' : index === 1 ? 'top-2' : index === 2 ? 'top-3' : '';
					const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
					return `
						<li class="leaderboard-item ${rankClass}">
							<span class="leaderboard-rank">${medal}</span>
							<span class="leaderboard-name">${score.username}</span>
							<span class="leaderboard-score">${score.score}</span>
						</li>
					`;
				}).join('');
			} catch (error)
            {
				console.error('Error loading memory leaderboard:', error);
                leaderboardEl.innerHTML = '<li class="no-scores">Error loading scores</li>';
			}
		}

		// ===== MODAL MANAGEMENT =====
		function openGame(game) {
			if (!currentUser) {
				// En lugar de alert(), mostrar el nuevo modal
				document.getElementById('loginAlert').classList.add('active');
				return;
			}

			if (game === 'catch') {
				document.getElementById('catchModal').classList.add('active');
			} else if (game === 'memory') {
				document.getElementById('memoryModal').classList.add('active');
				initMemoryGame();
			}
		}

		function closeGame(game) {
			if (game === 'catch') {
				stopCatchGame();
				document.getElementById('catchModal').classList.remove('active');
			} else if (game === 'memory') {
				document.getElementById('memoryModal').classList.remove('active');
			}
		}

		// Funci√≥n para cerrar la alerta de login
		function closeLoginAlert() {
			document.getElementById('loginAlert').classList.remove('active');
		}

		// Funci√≥n para cerrar la victoria de Memory
		function closeMemoryVictory() {
			document.getElementById('memoryVictoryAlert').classList.remove('active');
			initMemoryGame(); // Reinicia autom√°ticamente
		}

		// ===== CATCH GAME =====
		let catchGameActive = false;
		let catchScore = 0;
		let catchTime = 30;
		let catchMultiplier = 1;
		let catchInterval;
		let catchTimer;
		let itemCheckIntervals = [];
		let hasShield = false;
		let catcherSpeed = 1;

		function startCatchGame() {
			if (catchGameActive || !currentUser) return;
			
			document.getElementById('gameOverAlert').classList.remove('active');
			
			catchGameActive = true;
			catchScore = 0;
			catchTime = 30;
			catchMultiplier = 1;
			hasShield = false;
			catcherSpeed = 1;
			
			document.getElementById('catchScore').textContent = catchScore;
			document.getElementById('catchTime').textContent = catchTime;
			document.getElementById('catchMultiplier').textContent = 'x' + catchMultiplier;
			document.getElementById('catcher').style.filter = 'drop-shadow(0 0 10px rgba(255, 190, 11, 0.8))';
			
			document.querySelectorAll('.falling-item').forEach(item => item.remove());
			
			document.getElementById('catchStartBtn').disabled = true;
			
			catchInterval = setInterval(createFallingItem, 700);
			catchTimer = setInterval(() => {
				catchTime--;
				document.getElementById('catchTime').textContent = catchTime;
				if (catchTime <= 0) {
					stopCatchGame();
					showGameOverAlert();
				}
			}, 1000);
		}

		function stopCatchGame() {
			catchGameActive = false;
			clearInterval(catchInterval);
			clearInterval(catchTimer);
			
			itemCheckIntervals.forEach(interval => clearInterval(interval));
			itemCheckIntervals = [];
			
			document.querySelectorAll('.falling-item').forEach(item => item.remove());
			
			document.getElementById('catchStartBtn').disabled = false;
		}

		function createFallingItem() {
			if (!catchGameActive) return;
			
			const item = document.createElement('div');
			item.className = 'falling-item';
			
			const rand = Math.random();
			let itemType;
			
			if (rand < 0.15) {
				itemType = 'bomb';
				item.textContent = 'üí£';
			} else if (rand < 0.25) {
				// Power-ups
				const powerups = ['‚ö°', 'üåü', '‚è∞', 'üõ°Ô∏è'];
				const powerup = powerups[Math.floor(Math.random() * powerups.length)];
				item.textContent = powerup;
				itemType = 'powerup';
				item.dataset.powerup = powerup;
				item.classList.add('powerup');
			} else {
				itemType = 'star';
				item.textContent = '‚≠ê';
			}
			
			item.dataset.type = itemType;
			
			const gameWidth = document.getElementById('catchGameArea').offsetWidth;
			item.style.left = Math.random() * (gameWidth - 60) + 'px';
			item.style.top = '-80px'; // M√°s arriba para dar m√°s espacio

			const baseDuration = Math.random() * 1.5 + 4; // Duraci√≥n m√°s larga y menos aleatoria
			const duration = baseDuration / catcherSpeed;
			item.style.animation = `fall ${duration}s linear`;
			
			document.getElementById('catchGameArea').appendChild(item);
			
			let hasCollided = false;
			
			const checkCollision = setInterval(() => {
				if (!catchGameActive || !item.parentElement || hasCollided) {
					clearInterval(checkCollision);
					const index = itemCheckIntervals.indexOf(checkCollision);
					if (index > -1) itemCheckIntervals.splice(index, 1);
					return;
				}
				
				const itemRect = item.getBoundingClientRect();
				const catcherRect = document.getElementById('catcher').getBoundingClientRect();
				
				if (itemRect.bottom >= catcherRect.top &&
					itemRect.top <= catcherRect.bottom &&
					itemRect.right >= catcherRect.left &&
					itemRect.left <= catcherRect.right) {
					
					hasCollided = true;
					
					if (item.dataset.type === 'star') {
						catchScore += 10 * catchMultiplier;
						document.getElementById('catchScore').textContent = catchScore;
						item.style.transition = 'transform 0.2s ease-out, opacity 0.2s ease-out';
						item.style.transform = 'scale(2)';
						item.style.opacity = '0';
					} else if (item.dataset.type === 'powerup') {
						applyPowerup(item.dataset.powerup);
						item.style.transition = 'transform 0.3s ease-out, opacity 0.3s ease-out';
						item.style.transform = 'scale(2) rotate(360deg)';
						item.style.opacity = '0';
					} else if (item.dataset.type === 'bomb') {
						if (!hasShield) {
							catchScore = Math.max(0, catchScore - 30);
							document.getElementById('catchScore').textContent = catchScore;
							
							const catcher = document.getElementById('catcher');
							catcher.style.animation = 'shake 0.3s ease-in-out';
							setTimeout(() => catcher.style.animation = '', 300);
						} else {
							hasShield = false;
							document.getElementById('catcher').style.filter = 'drop-shadow(0 0 10px rgba(255, 190, 11, 0.8))';
						}
					}
					
					setTimeout(() => {
						if (item.parentElement) item.remove();
					}, 300);
					
					clearInterval(checkCollision);
					const index = itemCheckIntervals.indexOf(checkCollision);
					if (index > -1) itemCheckIntervals.splice(index, 1);
				}
			}, 30);
			
			itemCheckIntervals.push(checkCollision);
			
			setTimeout(() => {
				if (item.parentElement) item.remove();
				clearInterval(checkCollision);
				const index = itemCheckIntervals.indexOf(checkCollision);
				if (index > -1) itemCheckIntervals.splice(index, 1);
			}, duration * 1000 + 1000); // Aumentado de 500 a 1000ms extra
		}

		function applyPowerup(powerup) {
			switch(powerup) {
				case '‚ö°':
					catcherSpeed = 1.5;
					setTimeout(() => catcherSpeed = 1, 5000);
					break;
				case 'üåü':
					catchMultiplier = 2;
					document.getElementById('catchMultiplier').textContent = 'x' + catchMultiplier;
					setTimeout(() => {
						catchMultiplier = 1;
						document.getElementById('catchMultiplier').textContent = 'x' + catchMultiplier;
					}, 5000);
					break;
				case '‚è∞':
					catchTime += 10;
					document.getElementById('catchTime').textContent = catchTime;
					break;
				case 'üõ°Ô∏è':
					hasShield = true;
					document.getElementById('catcher').style.filter = 'drop-shadow(0 0 20px rgba(0, 255, 249, 1))';
					break;
			}
		}

		async function showGameOverAlert() {
			document.getElementById('finalScore').textContent = catchScore;
			document.getElementById('gameOverAlert').classList.add('active');
			await saveScore('catch', catchScore);
		}

		function closeGameOverAlert() {
			document.getElementById('gameOverAlert').classList.remove('active');
		}

		let catcherX = 0;
		document.getElementById('catchGameArea').addEventListener('mousemove', (e) => {
			if (!catchGameActive) return;
			const game = document.getElementById('catchGameArea');
			const catcher = document.getElementById('catcher');
			const rect = game.getBoundingClientRect();
			catcherX = e.clientX - rect.left - 40;
			catcherX = Math.max(0, Math.min(catcherX, game.offsetWidth - 80));
			catcher.style.left = catcherX + 'px';
		});

		// Touch support for mobile
		document.getElementById('catchGameArea').addEventListener('touchmove', (e) => {
			if (!catchGameActive) return;
			e.preventDefault();
			const game = document.getElementById('catchGameArea');
			const catcher = document.getElementById('catcher');
			const rect = game.getBoundingClientRect();
			const touch = e.touches[0];
			catcherX = touch.clientX - rect.left - 40;
			catcherX = Math.max(0, Math.min(catcherX, game.offsetWidth - 80));
			catcher.style.left = catcherX + 'px';
		});

		// ===== MEMORY GAME =====
		const emojis = ['üéÆ', 'üïπÔ∏è', 'üëæ', 'üéØ', 'üé≤', 'üÉè', 'üé∞', 'üèÜ'];
		let memoryCards = [];
		let flippedCards = [];
		let moves = 0;
		let pairs = 0;
		let memoryGameActive = false;
		let memoryStartTime = 0;
		let memoryTimer;

		function initMemoryGame() {
			if (!currentUser) return;
			
			const gameContainer = document.getElementById('memoryGrid');
			gameContainer.innerHTML = '';
			memoryCards = [...emojis, ...emojis].sort(() => Math.random() - 0.5);
			flippedCards = [];
			moves = 0;
			pairs = 0;
			memoryGameActive = true;
			memoryStartTime = Date.now();
			
			document.getElementById('memoryMoves').textContent = moves;
			document.getElementById('memoryPairs').textContent = `${pairs}/8`;

			memoryCards.forEach((emoji, index) => {
				const card = document.createElement('div');
				card.className = 'memory-card';
				card.dataset.emoji = emoji;
				card.dataset.index = index;
				card.addEventListener('click', flipCard);
				gameContainer.appendChild(card);
			});
		}

		function flipCard() {
			if (!memoryGameActive) return;
			if (flippedCards.length === 2 || this.classList.contains('flipped') || this.classList.contains('matched')) {
				return;
			}

			this.textContent = this.dataset.emoji;
			this.classList.add('flipped');
			flippedCards.push(this);

			if (flippedCards.length === 2) {
				moves++;
				document.getElementById('memoryMoves').textContent = moves;
				
				setTimeout(async () => {
					if (flippedCards[0].dataset.emoji === flippedCards[1].dataset.emoji) {
						flippedCards[0].classList.add('matched');
						flippedCards[1].classList.add('matched');
						pairs++;
						document.getElementById('memoryPairs').textContent = `${pairs}/8`;
						
						if (pairs === 8) {
							memoryGameActive = false;
							clearInterval(memoryTimer);
							setTimeout(async () => {
								// Mostrar el nuevo modal personalizado
								document.getElementById('finalMoves').textContent = moves;
								document.getElementById('memoryVictoryAlert').classList.add('active');
								await saveScore('memory', moves);
							}, 300);
						}
					} else {
						flippedCards[0].textContent = '';
						flippedCards[1].textContent = '';
						flippedCards[0].classList.remove('flipped');
						flippedCards[1].classList.remove('flipped');
					}
					flippedCards = [];
				}, 800);
			}
		}

		// Add shake and fall animations
		const style = document.createElement('style');
		style.textContent = `
			@keyframes shake {
				0%, 100% { transform: translateX(0); }
				25% { transform: translateX(-10px); }
				75% { transform: translateX(10px); }
			}
			@keyframes fall {
				to { transform: translateY(550px); }
			}
		`;
		document.head.appendChild(style);

		// Load leaderboards on page load
		window.addEventListener('load', async () => {
			// Esperar a que storage est√© disponible
			let attempts = 0;
			const checkStorage = setInterval(async () => {
				attempts++;
				if (isStorageAvailable()) {
					clearInterval(checkStorage);
					await loadLeaderboards();
				} else if (attempts > 20) {
					clearInterval(checkStorage);
					console.log('Storage not available after 2 seconds');
					document.getElementById('catchLeaderboard').innerHTML = '<li class="no-scores">Storage not available</li>';
					document.getElementById('memoryLeaderboard').innerHTML = '<li class="no-scores">Storage not available</li>';
				}
			}, 100);
		});
	</script>
	</body>
</html>
